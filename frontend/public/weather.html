<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
        }

        .location-header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeIn 0.5s ease-in;
        }

        .location-name {
            font-size: 28px;
            font-weight: 300;
            margin-bottom: 5px;
        }

        .current-time {
            font-size: 14px;
            opacity: 0.8;
        }

        .current-weather {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.6s ease-out;
        }

        .temp-main {
            font-size: 72px;
            font-weight: 200;
            text-align: center;
            margin: 20px 0;
        }

        .weather-desc {
            text-align: center;
            font-size: 20px;
            margin-bottom: 25px;
            opacity: 0.9;
        }

        .weather-icon {
            text-align: center;
            font-size: 80px;
            margin: 20px 0;
        }

        .weather-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .detail-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            text-align: center;
        }

        .detail-label {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .detail-value {
            font-size: 20px;
            font-weight: 500;
        }

        .hourly-forecast {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.7s ease-out;
        }

        .section-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .hourly-scroll {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding: 10px 0;
            scrollbar-width: none;
        }

        .hourly-scroll::-webkit-scrollbar {
            display: none;
        }

        .hourly-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            min-width: 70px;
            text-align: center;
            flex-shrink: 0;
        }

        .hourly-time {
            font-size: 13px;
            margin-bottom: 10px;
            opacity: 0.8;
        }

        .hourly-icon {
            font-size: 30px;
            margin: 10px 0;
        }

        .hourly-temp {
            font-size: 16px;
            font-weight: 500;
        }

        .daily-forecast {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.8s ease-out;
        }

        .daily-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin-bottom: 10px;
        }

        .daily-day {
            flex: 1;
            font-size: 15px;
        }

        .daily-icon {
            font-size: 28px;
            margin: 0 15px;
        }

        .daily-temps {
            display: flex;
            gap: 10px;
            font-size: 15px;
        }

        .temp-max {
            font-weight: 600;
        }

        .temp-min {
            opacity: 0.6;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 18px;
        }

        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #fff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        .error {
            background: rgba(255, 59, 48, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .refresh-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .refresh-btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Loading weather data...</p>
        </div>

        <div id="weather-content" style="display: none;">
            <div class="location-header">
                <div class="location-name" id="location-name">Loading...</div>
                <div class="current-time" id="current-time"></div>
            </div>

            <div class="current-weather">
                <div class="weather-icon" id="weather-icon">‚òÄÔ∏è</div>
                <div class="temp-main" id="temp-main">--¬∞</div>
                <div class="weather-desc" id="weather-desc">Loading...</div>
                
                <div class="weather-details">
                    <div class="detail-item">
                        <div class="detail-label">Feels like</div>
                        <div class="detail-value" id="feels-like">--¬∞</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Humidity</div>
                        <div class="detail-value" id="humidity">--%</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Wind Speed</div>
                        <div class="detail-value" id="wind-speed">-- km/h</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Precipitation</div>
                        <div class="detail-value" id="precipitation">-- mm</div>
                    </div>
                </div>
            </div>

            <div class="hourly-forecast">
                <div class="section-title">Hourly Forecast</div>
                <div class="hourly-scroll" id="hourly-forecast"></div>
            </div>

            <div class="daily-forecast">
                <div class="section-title">7-Day Forecast</div>
                <div id="daily-forecast"></div>
            </div>
        </div>

        <div id="error" class="error" style="display: none;">
            <p>Unable to load weather data. Please check your location settings and try again.</p>
        </div>
    </div>

    <button class="refresh-btn" onclick="loadWeather()" title="Refresh">‚Üª</button>

    <script>
        // Weather code to emoji/icon mapping
        const weatherCodes = {
            0: { icon: '‚òÄÔ∏è', desc: 'Clear sky' },
            1: { icon: 'üå§Ô∏è', desc: 'Mainly clear' },
            2: { icon: '‚õÖ', desc: 'Partly cloudy' },
            3: { icon: '‚òÅÔ∏è', desc: 'Overcast' },
            45: { icon: 'üå´Ô∏è', desc: 'Foggy' },
            48: { icon: 'üå´Ô∏è', desc: 'Depositing rime fog' },
            51: { icon: 'üå¶Ô∏è', desc: 'Light drizzle' },
            53: { icon: 'üå¶Ô∏è', desc: 'Moderate drizzle' },
            55: { icon: 'üåßÔ∏è', desc: 'Dense drizzle' },
            61: { icon: 'üåßÔ∏è', desc: 'Slight rain' },
            63: { icon: 'üåßÔ∏è', desc: 'Moderate rain' },
            65: { icon: '‚õàÔ∏è', desc: 'Heavy rain' },
            71: { icon: 'üå®Ô∏è', desc: 'Slight snow' },
            73: { icon: 'üå®Ô∏è', desc: 'Moderate snow' },
            75: { icon: '‚ùÑÔ∏è', desc: 'Heavy snow' },
            77: { icon: 'üå®Ô∏è', desc: 'Snow grains' },
            80: { icon: 'üå¶Ô∏è', desc: 'Slight rain showers' },
            81: { icon: 'üåßÔ∏è', desc: 'Moderate rain showers' },
            82: { icon: '‚õàÔ∏è', desc: 'Violent rain showers' },
            85: { icon: 'üå®Ô∏è', desc: 'Slight snow showers' },
            86: { icon: '‚ùÑÔ∏è', desc: 'Heavy snow showers' },
            95: { icon: '‚õàÔ∏è', desc: 'Thunderstorm' },
            96: { icon: '‚õàÔ∏è', desc: 'Thunderstorm with hail' },
            99: { icon: '‚õàÔ∏è', desc: 'Thunderstorm with heavy hail' }
        };

        function updateCurrentTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            document.getElementById('current-time').textContent = now.toLocaleDateString('en-US', options);
        }

        function getWeatherInfo(code) {
            return weatherCodes[code] || { icon: 'üå°Ô∏è', desc: 'Unknown' };
        }

        async function getLocationName(lat, lon) {
            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
                const data = await response.json();
                return data.address.city || data.address.town || data.address.village || data.address.county || 'Unknown Location';
            } catch (error) {
                return 'Your Location';
            }
        }

        async function fetchWeatherData(lat, lon) {
            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m&hourly=temperature_2m,weather_code,precipitation_probability&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum&timezone=auto`;
            
            const response = await fetch(url);
            if (!response.ok) throw new Error('Weather API error');
            return await response.json();
        }

        function displayCurrentWeather(data, locationName) {
            const current = data.current;
            const weatherInfo = getWeatherInfo(current.weather_code);

            document.getElementById('location-name').textContent = locationName;
            document.getElementById('weather-icon').textContent = weatherInfo.icon;
            document.getElementById('temp-main').textContent = `${Math.round(current.temperature_2m)}¬∞`;
            document.getElementById('weather-desc').textContent = weatherInfo.desc;
            document.getElementById('feels-like').textContent = `${Math.round(current.apparent_temperature)}¬∞`;
            document.getElementById('humidity').textContent = `${current.relative_humidity_2m}%`;
            document.getElementById('wind-speed').textContent = `${Math.round(current.wind_speed_10m)} km/h`;
            document.getElementById('precipitation').textContent = `${current.precipitation} mm`;
        }

        function displayHourlyForecast(data) {
            const hourlyContainer = document.getElementById('hourly-forecast');
            hourlyContainer.innerHTML = '';

            for (let i = 0; i < 24; i++) {
                const time = new Date(data.hourly.time[i]);
                const temp = Math.round(data.hourly.temperature_2m[i]);
                const weatherInfo = getWeatherInfo(data.hourly.weather_code[i]);
                
                const hourlyItem = document.createElement('div');
                hourlyItem.className = 'hourly-item';
                hourlyItem.innerHTML = `
                    <div class="hourly-time">${time.getHours()}:00</div>
                    <div class="hourly-icon">${weatherInfo.icon}</div>
                    <div class="hourly-temp">${temp}¬∞</div>
                `;
                hourlyContainer.appendChild(hourlyItem);
            }
        }

        function displayDailyForecast(data) {
            const dailyContainer = document.getElementById('daily-forecast');
            dailyContainer.innerHTML = '';

            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

            for (let i = 0; i < 7; i++) {
                const date = new Date(data.daily.time[i]);
                const dayName = i === 0 ? 'Today' : days[date.getDay()];
                const maxTemp = Math.round(data.daily.temperature_2m_max[i]);
                const minTemp = Math.round(data.daily.temperature_2m_min[i]);
                const weatherInfo = getWeatherInfo(data.daily.weather_code[i]);

                const dailyItem = document.createElement('div');
                dailyItem.className = 'daily-item';
                dailyItem.innerHTML = `
                    <div class="daily-day">${dayName}</div>
                    <div class="daily-icon">${weatherInfo.icon}</div>
                    <div class="daily-temps">
                        <span class="temp-max">${maxTemp}¬∞</span>
                        <span class="temp-min">${minTemp}¬∞</span>
                    </div>
                `;
                dailyContainer.appendChild(dailyItem);
            }
        }

        async function loadWeather() {
            try {
                document.getElementById('loading').style.display = 'block';
                document.getElementById('weather-content').style.display = 'none';
                document.getElementById('error').style.display = 'none';

                if (!navigator.geolocation) {
                    throw new Error('Geolocation not supported');
                }

                navigator.geolocation.getCurrentPosition(async (position) => {
                    try {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;

                        const [weatherData, locationName] = await Promise.all([
                            fetchWeatherData(lat, lon),
                            getLocationName(lat, lon)
                        ]);

                        displayCurrentWeather(weatherData, locationName);
                        displayHourlyForecast(weatherData);
                        displayDailyForecast(weatherData);
                        updateCurrentTime();

                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('weather-content').style.display = 'block';
                    } catch (error) {
                        console.error('Error fetching weather:', error);
                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('error').style.display = 'block';
                    }
                }, (error) => {
                    console.error('Geolocation error:', error);
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('error').style.display = 'block';
                });
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
            }
        }

        // Update time every minute
        setInterval(updateCurrentTime, 60000);

        // Load weather on page load
        loadWeather();
    </script>
</body>
</html>
